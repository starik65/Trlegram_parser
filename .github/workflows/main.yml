name: üöÄ Telegram Parser & n8n Sender (–°–µ—Å—Å–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª)

on:
  # 1. –ó–∞–ø—É—Å–∫ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (–ö–ê–ñ–î–´–ï 2 –ß–ê–°–ê —Å 09:00 –¥–æ 23:00 –ø–æ –°–æ—á–∏/–ú–°–ö)
  schedule:
    # 0 6,8,10,12,14,16,18,20 * * *
    # –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç 09:00, 11:00, 13:00, 15:00, 17:00, 19:00, 21:00, 23:00 –ø–æ UTC+3
    - cron: '0 6,8,10,12,14,16,18,20 * * *'
    
  # 2. –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
  workflow_dispatch:
    inputs:
      webhook_url:
        description: 'URL –≤–∞—à–µ–≥–æ n8n Webhook'
        required: true
        default: 'https://your.n8n.webhook.url'

jobs:
  run-parser:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Set up Python and Dependencies
        uses: actions/setup-python@v5
        with:
          python-version: '3.x' 
      - run: pip install telethon requests

      - name: Run Telegram Parser and Send to n8n
        # –ó–∞–ø—É—Å–∫–∞–µ—Ç –≥–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç
        run: python3 main_parser.py
        env:
          API_ID: ${{ secrets.API_ID }} 
          API_HASH: ${{ secrets.API_HASH }}
          # –ò—Å–ø–æ–ª—å–∑—É–µ—Ç URL –∏–∑ —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞ –ò–õ–ò –∏–∑ Secrets (–¥–ª—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è)
          N8N_WEBHOOK_URL: ${{ github.event.inputs.webhook_url || secrets.N8N_WEBHOOK_URL }} 
